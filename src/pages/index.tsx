import React from 'react';
import clsx from 'clsx';
import useDocusaurusContext from '@docusaurus/useDocusaurusContext';
import Layout from '@theme/Layout';

import styles from './index.module.scss';
import { observer } from 'mobx-react-lite';
import useBaseUrl from '@docusaurus/useBaseUrl';
import Section from '../components/shared/Section';
import { translate } from '@docusaurus/Translate';
import Icon from '@mdi/react';
import {
    mdiAccountCircleOutline,
    mdiBookOpenVariantOutline,
    mdiCalendarAccount,
    mdiCalendarMonth,
    mdiCalendarSync,
    mdiChartTimeline,
    mdiMicrosoftOutlook,
    mdiPalette,
    mdiSecurity,
    mdiViewList
} from '@mdi/js';
import Link from '@docusaurus/Link';
import { useStore } from '../stores/hooks';
import Badge from '../components/shared/Badge';
import { Timeline } from '../components/shared/icons';
import Details from '@theme/Details';
import VideoGrid from '@site/src/components/VideoGrid';

function HomepageHeader() {
    const { siteConfig } = useDocusaurusContext();
    return (
        <header className={clsx('hero hero--primary', styles.heroBanner)}>
            <div className="container">
                <h1 className="hero__title">{siteConfig.title}</h1>
                <p className="hero__subtitle">{siteConfig.tagline}</p>
                {/* <img src='/img/events.png' /> */}
            </div>
        </header>
    );
}

interface NavProps {
    icon: string;
    to: string;
    label: string;
    displayFor: 'public' | 'admin' | 'user';
}
const NavCard = observer((props: NavProps) => {
    const userStore = useStore('userStore');
    if (props.displayFor === 'admin' && !userStore.current?.isAdmin) {
        return null;
    }
    if (props.displayFor === 'user' && !userStore.current) {
        return null;
    }
    return (
        <Link to={props.to} className={clsx('card', styles.navCard)}>
            <div className={clsx('card__image', styles.navCardIcon)}>
                <Icon path={props.icon} size={3} color={'var(--ifm-color-primary)'} />
            </div>
            <div className={clsx('card__footer', styles.navCardBody)}>
                <button className={clsx('button', 'button--primary', 'button--block')}>{props.label}</button>
            </div>
        </Link>
    );
});

const Home = observer(() => {
    const { i18n } = useDocusaurusContext();
    const ref = React.useRef<HTMLVideoElement>(null);
    React.useEffect(() => {
        if (ref.current) {
            ref.current.playbackRate = 0.5;
        }
    }, [ref]);
    return (
        <Layout title="Events" description="Events Application">
            <HomepageHeader />
            <main>
                <Section className={clsx(styles.navCardSection)}>
                    <div className={clsx(styles.navCards)}>
                        <NavCard
                            icon={mdiViewList}
                            to={useBaseUrl('/table')}
                            label={translate({
                                message: 'Tabelle',
                                id: 'navcard.table.text',
                                description: 'Button text for navigating to the table page'
                            })}
                            displayFor="public"
                        />
                        <NavCard
                            icon={mdiCalendarMonth}
                            to={useBaseUrl('/calendar')}
                            label={translate({
                                message: 'Kalender',
                                id: 'navcard.calendar.text',
                                description: 'Button text for navigating to the calendar page'
                            })}
                            displayFor="public"
                        />
                        <NavCard
                            icon={Timeline}
                            to={useBaseUrl('/gantt')}
                            label={translate({
                                message: 'Zeitachse',
                                id: 'navcard.gantt.text',
                                description: 'Button text for navigating to the gantt page'
                            })}
                            displayFor="public"
                        />
                        <NavCard
                            icon={mdiCalendarSync}
                            to={useBaseUrl('/subscribe')}
                            label={translate({
                                message: 'Abonnieren',
                                id: 'navcard.subscribe.text',
                                description: 'Button text for navigating to the subscribe page'
                            })}
                            displayFor="public"
                        />
                        <NavCard
                            icon={mdiBookOpenVariantOutline}
                            to={useBaseUrl('/docs')}
                            label={translate({
                                message: 'Dokumentation',
                                id: 'navcard.docs.text',
                                description: 'Button text for navigating to the documentation page'
                            })}
                            displayFor="public"
                        />
                        <NavCard
                            icon={mdiAccountCircleOutline}
                            to={useBaseUrl('/user?user-tab=account')}
                            label={translate({
                                message: 'Account',
                                id: 'navcard.user.account',
                                description: 'Button text for navigating to the user account page'
                            })}
                            displayFor="user"
                        />
                        <NavCard
                            icon={mdiCalendarAccount}
                            to={useBaseUrl('/user?user-tab=events')}
                            label={translate({
                                message: 'Meine Events',
                                id: 'navcard.user.events',
                                description: 'Button text for navigating to the users events page'
                            })}
                            displayFor="user"
                        />
                        <NavCard
                            icon={mdiSecurity}
                            to={useBaseUrl('/admin')}
                            label={translate({
                                message: 'Admin',
                                id: 'navcard.admin.text',
                                description: 'Button text for navigating to the admin page'
                            })}
                            displayFor="admin"
                        />
                    </div>
                </Section>
                <Section>
                    {i18n?.currentLocale === 'de' ? (
                        <div className="card" style={{ boxShadow: 'var(--ifm-global-shadow-md)' }}>
                            <div className="card__header">
                                <h2>Einf√ºhrung Terminkalender</h2>
                            </div>
                            <div className="card__body">
                                Der Terminkalender ist noch in der Einf√ºhrungsphase, was folgende
                                Einschr√§nkungen mit sich bringt:
                                <ul>
                                    <li>
                                        <b>Erfasste Termine werden erst f√ºr das FS2025 ver√∂ffentlicht.</b>
                                    </li>
                                    <li>
                                        Die URL der abonnierten Kalender k√∂nnte sich w√§hrend der
                                        Einf√ºhrungsphase √§ndern. Dann w√ºrden Sie informiert und m√ºssten den
                                        Kalender erneut abonnieren.
                                    </li>
                                    <li>
                                        Nicht alles wird bereits perfekt funktionieren. R√ºckmeldungen zu
                                        Fehlern oder Anregungen sind nach wie vor sehr willkommen.
                                    </li>
                                </ul>
                                <h3>Vielen Dank f√ºr die Mithilfe!</h3>
                            </div>
                            <div className="card__header">
                                <h1>Wie funktioniert's?</h1>
                            </div>
                            <div className="card__body">
                                <VideoGrid
                                    videos={[
                                        {
                                            src: '/videos/Events-Anmelden.mp4',
                                            title: 'üëâ Anmelden',
                                            href: '/docs/login'
                                        },
                                        {
                                            src: '/videos/Events-Filtern.mp4',
                                            title: 'üëâ Filtern',
                                            href: '/docs/events/filter'
                                        },
                                        {
                                            src: '/videos/Events-Abonnieren.mp4',
                                            title: 'üëâ Abonnieren',
                                            href: 'docs/events/subscribe'
                                        },
                                        {
                                            src: '/videos/events-ruttl-de.mp4',
                                            title: 'üëâ Feedback',
                                            href: 'docs/betaphase',
                                            playbackRate: 0.5
                                        }
                                    ]}
                                />
                            </div>
                            <div className="card__body">
                                <Details summary="Neuerungen des Terminkalenders">
                                    <h3>Changelog</h3>
                                    <h4>Version: Release Candidate 1.0 (27.06.2024)</h4>
                                    <ul>
                                        <li>
                                            üöÄüíÖ Neu: In Gruppen oder beim Import kann zwischen den
                                            verschiedenen Ansichten umgestellt werden
                                        </li>
                                        <li>
                                            üöÄ: Anleitungen mit kurzen Videos in die Dokumentation
                                            aufgenommen.
                                        </li>
                                        <li>
                                            üêõ Fix: Die Terminfilterung nach eigenen Terminen funktioniert
                                            zuverl√§ssiger und schneller.
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.11 (05.05.2024)</h4>
                                    <ul>
                                        <li>
                                            üöÄüíÖ Neu: Benutzende k√∂nnen selber die Hauptfarbe einstellen. In
                                            der Navigationsliste auf{' '}
                                            <Badge
                                                icon={mdiPalette}
                                                color="primary"
                                                className={styles.inline}
                                                size={0.6}
                                            />{' '}
                                            klicken und die Farbe einstellen.
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.10 (29.04.2024)</h4>
                                    <ul>
                                        <li>üöÄ Neu: Dokumentation und Gebrauchsanweisungen Verlinkt</li>
                                        <li>
                                            üöÄ Neu: Aktualisierte, aber noch nicht ver√∂ffentlichte Termine
                                            k√∂nnen in einer √úbersicht dargestellt werden.
                                        </li>
                                        <li>üíÖ Aktionen f√ºr Termine werden √ºbersichtlicher dargestellt.</li>
                                        <li>
                                            üíÖ Icons und Tooltips zeigen an, ob ein Termin direkt aktualisiert
                                            wird, oder eine neue Version erzeugt wird.
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.9 (28.04.2024)</h4>
                                    <ul>
                                        <li>
                                            üíÖ Neue Zeilen werden bei den Beschreibungen korrekt angezeigt.
                                        </li>
                                        <li>
                                            üíÖ Rechts-Klick oder langes dr√ºcken auf Tablets √∂ffnet die
                                            Termin-√úbersicht.
                                        </li>
                                        <li>
                                            üíÖ Ist in der Tabelle bei einem Termin kein Text ausgew√§hlt, kann
                                            eine Zeile auch durch erneutes Klicken reduziert werden.
                                        </li>
                                        <li>üíÖ Zeige den "Edit" Knopf bei unver√∂ffentlichten Terminen an.</li>
                                        <li>
                                            üöÄ Neu: Termine in der √úbersicht k√∂nnen ausgew√§hlt, geteilt und zu
                                            einer Gruppe hinzugef√ºgt werden.
                                        </li>
                                        <li>
                                            üêõ Fix: Der "Termin Hinzuf√ºgen" Knopf wurde nicht angezeigt, wenn
                                            noch keine Termine vorhanden waren.
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.8 (17.04.2024)</h4>
                                    <ul>
                                        <li>
                                            üíÖ Layoutverbesserungen
                                            <ul>
                                                <li>Farben im Dark-Mode angepasst f√ºr besseren Kontrast.</li>
                                                <li>
                                                    Kalender-Ansicht: Zeige Wochentag, Tag und Monat (neu: Mo.
                                                    15.4, alt: 15 Mo)
                                                </li>
                                                <li>
                                                    Tabellen-Ansicht: Die Wochen-Balken sind nun st√§rker
                                                    hervorgehoben (+2pt und mit Farbe ausgef√ºllt)
                                                </li>
                                                <li>
                                                    Herk√∂mmliche Datumsdarstellung wo sinnvoll (6.4.24 statt
                                                    06.04.2024)
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            üöÄ Neu: Erkl√§rende Popups √ºber den Kn√∂pfen und Elementen in der
                                            Tabelle.
                                        </li>
                                        <li>
                                            üíÖ Ist eine Zeile in der Tabellensicht erweitert, kann sie auch
                                            durch Klicken auf "Lektionen Betroffen Knopf" üî¥üü°üü¢ wieder
                                            reduziert werden.
                                        </li>
                                        <li>
                                            üíÖ Mit <kbd>ctrl + Klick</kbd> kann die Termin√ºbersicht ge√∂ffnet
                                            werden.
                                        </li>
                                        <li>üöÄ Neu: Eingabefenster f√ºr Termine hinzugef√ºgt.</li>
                                        <li>
                                            üêõ Fix: Bei der Termineingabe muss nun mindestens eine Zielgruppe
                                            ausgew√§hlt werden (Klasse, Stufe oder Abteilung)
                                        </li>
                                        <li>üöÄ Neu: Download-Format des Excel-Exports.</li>
                                        <li>
                                            üêõ Fix: Der Excel-Export f√ºgt nur die angezeigten Termine ins
                                            Excel ein.
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.7 (26.02.2024)</h4>
                                    <ul>
                                        <li>
                                            üíÖ Verbesserung: Wird der Start oder das Ende eines Termins
                                            ver√§ndert, so dass der "Start" nach dem "Ende" erfolgt, wird
                                            automatisch ein zul√§ssiges Datum gesetzt.
                                        </li>
                                        <li>
                                            üöÄ Neu: Benachrichtigungen: In den{' '}
                                            <Link to="/user?user-tab=account">üëâ Benutzereinstellungen</Link>{' '}
                                            kann festgelegt werden, ob man bei Termin√§nderungen, die einem
                                            betreffen, per Mail benachrichtigt werden m√∂chte. Benachrichtigt
                                            wirst du, wenn:
                                            <ul>
                                                <li>Ein Termin der dich betrifft, gel√∂scht wird.</li>
                                                <li>Ein Termin ver√§ndert wird, der dich betrifft.</li>
                                                <li>Ein Termin hinzugef√ºgt wird, der dich betrifft.</li>
                                                <li>
                                                    Ein Termin so ver√§ndert wird, dass er dich nun nicht mehr
                                                    betrifft.
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            üöÄ Neu: Termine k√∂nnen zu einer Gruppe gruppiert werden:
                                            <ul>
                                                <li>Eigene Termine k√∂nnen zu Gruppen hinzugef√ºgt werden.</li>
                                                <li>
                                                    √ñffentliche Termine k√∂nnen zu Gruppen hinzugef√ºgt werden.
                                                </li>
                                                <li>Gruppen k√∂nnen kopiert werden.</li>
                                                <li>
                                                    Es gibt einen Editor zum verschieben aller Start- und
                                                    Enddaten um eine feste Anzahl Tage/Stunden von Terminen in
                                                    einer Gruppe.
                                                </li>
                                                <li>Gruppen k√∂nnen mit anderen Personen geteilt werden.</li>
                                            </ul>
                                        </li>
                                        <li>
                                            üêõ Fix: Klassengruppen wurden in der Termin√ºbersicht
                                            f√§lschlicherweise nicht angezeigt.
                                        </li>
                                        <li>
                                            üêõ Fix: Beim Neuladen der User-Seite wird wieder der zuvor
                                            ausgew√§hlte Tab angezeigt.
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.6 (11.02.2024)</h4>
                                    <ul>
                                        <li>
                                            üöÄ Neu: Beim Erfassen eines Termins werden nun Erkl√§rungen f√ºr die
                                            Eigenschaft "Publikum: Alle/LP/KLP/SuS" angezeigt
                                        </li>
                                        <li>
                                            üöÄ Neu: Beim Laden des Profils werden automatisch nur Termine der{' '}
                                            <b>Abteilungen</b> (bspw. Gym GBSL) angezeigt, an welchen man
                                            unterrichtet.
                                        </li>
                                        <li>
                                            üíÖ Durch erneutes Klicken auf "Betroffene Lektionen laden" k√∂nnen
                                            diese nun auch wieder ausgeblendet werden.
                                        </li>
                                        <li>
                                            üêõ Fix: Falls sich das Login "aufh√§ngt" und oben Links durchgehend
                                            das "Profil" geladen wird, kann durch Klicken auf das Profil und
                                            anschliessendes "Aktualisieren" das Login neu angestossen werden.
                                        </li>
                                        <li>
                                            üêõ Fix: Wird ein Termin auf der franz√∂sischen Seite geklont,
                                            funktioniert die Weiterleitung nun korrekt.
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.5 (6.02.2024)</h4>
                                    <ul>
                                        <li>üêõ Fix: Firefox spielt Video ab</li>
                                        <li>
                                            üêõ Fix: Login sollte nun auf allen Browsern funktionieren und die
                                            Account-Daten werden auch nach dem ersten Login geladen.
                                        </li>
                                        <li>
                                            üîß Best√§tigung f√ºr das L√∂schen eines Events ist nun ein Popup.
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.4 (22.01.2024)</h4>
                                    <ul>
                                        <li>
                                            üöÄ Eingabe: Option f√ºr die Eingabe von ganzt√§gigen Terminen
                                            hinzugef√ºgt.
                                        </li>
                                        <li>
                                            üêõ Fix: Verbesserung des UI's wenn die
                                            Mehrfaktor-Authentifizierung notwendig ist.
                                        </li>
                                        <li>
                                            üíÖ Zeitachse: Titelleiste ist beim Scrollen oben am Fenster
                                            fixiert.
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.3 (15.01.2024)</h4>
                                    <ul>
                                        <li>
                                            üöÄ Inkrementelles Laden: Es werden die √∂ffentlichen Termine
                                            geladen, <b>w√§hrend</b> die Benutzer:in eingeloggt wird. Sobald
                                            die Anmeldeinformationen vorhanden sind, werden auch die
                                            pers√∂nlichen Daten geladen. F√ºhrt zu einem schnelleren Laden der
                                            Seite. <a href="https://github.com/lebalz/events-app/pull/17"></a>
                                        </li>
                                        <li>
                                            üíÖ Logout Button ist nun im sichtbaren Bereich auf der{' '}
                                            <a href="/user?user-tab=account">User-Seite</a>
                                        </li>
                                        <li>üêõ Fix: Abonnierbare Kalender sind korrekt beschriftet</li>
                                        <li>
                                            üêõ Fix: Kalenderwochen werden auch beim Jahreswechsel korrekt
                                            sortiert
                                        </li>
                                    </ul>
                                    <h4>Version: Beta 1.2 (07.01.2024)</h4>
                                    <ul>
                                        <li>
                                            üêõ Fix: Termin-Filter: Wer EF Unterrichtet, wurde bisher
                                            automatisch auch dem GBJB zugeteilt (bei EF's werden alle
                                            Gym-Klassen zugeteilt, also auch Nicht-Bilingue Klassen des GBJB,
                                            so dass bisher eine Zugeh√∂rigkeit zum GBJB abgeleitet wurde). F√ºr
                                            das EF bzw. OC ist dieser Fehler behoben. Falls bei anderen
                                            F√§chern ebenfalls Schul√ºbergreifend Klassen zugeordnet werden,
                                            gerne melden.{' '}
                                            <a
                                                href="https://github.com/lebalz/events-api/pull/9"
                                                target="_blank"
                                            >
                                                PR: Bilingue flag and relations for events
                                            </a>
                                        </li>
                                        <li>
                                            üöÄ Beim Erfassen von Terminen f√ºr Bilingua-Klassen, welche nur{' '}
                                            <i>LP</i> oder <i>ALLE</i> betreffen, kann nun angegeben werden,
                                            ob Lehrpersonen der abderen Schule auch betroffen sind (bspw. bei
                                            26Gn das GBJB oder bei 26mT das GBSL){' '}
                                        </li>
                                        <li>
                                            üöÄ Admin-Bereich: Bilingue-Departemente k√∂nnen nun den zugeh√∂rigen
                                            Schulen zugewiesen werden
                                        </li>
                                        <li>
                                            üöÄ Admin-Bereich: GBJB Import von CSV Dateien{' '}
                                            <a href="https://github.com/lebalz/events-api/pull/8">
                                                PR: Create import service for gbjb csv files
                                            </a>
                                        </li>
                                    </ul>
                                </Details>
                            </div>
                        </div>
                    ) : (
                        <div className="card" style={{ boxShadow: 'var(--ifm-global-shadow-md)' }}>
                            <div className="card__body">
                                L'agenda est encore en phase de lancement, ce qui implique les contraintes
                                suivantes :
                                <ul>
                                    <li>
                                        <b>
                                            Les √©v√®nements saisies ne seront publi√©es que pour le semestre de
                                            printemps 2025.
                                        </b>
                                    </li>
                                    <li>
                                        L'URL des calendriers abonn√©s pourrait changer pendant la phase de
                                        lancement. Dans ce cas, vous seriez inform√© et vous devriez s'abonner
                                        √† nouveau au calendrier.
                                    </li>
                                    <li>
                                        Tout ne fonctionnera pas d√©j√† parfaitement. Les commentaires sur les
                                        erreurs ou des suggestions sont toujours les bienvenues.
                                    </li>
                                </ul>
                                <h3>Merci beaucoup pour votre compr√©hension et votre aide</h3>
                            </div>
                            <div className="card__header">
                                <h1>Comment √ßa marche ?</h1>
                            </div>
                            <div className="card__body">
                                <VideoGrid
                                    videos={[
                                        {
                                            src: '/videos/ME-s-identifier.mp4',
                                            title: "S'identifier"
                                        },
                                        {
                                            src: '/videos/ME-les-filtres.mp4',
                                            title: 'Filtrer'
                                        },
                                        {
                                            src: '/videos/ME-s-abonner.mp4',
                                            title: "S'abonner"
                                        },
                                        {
                                            src: '/videos/ME-s-abonner-autre-agenda.mp4',
                                            title: "S'abonner √† un autre agenda"
                                        },
                                        {
                                            src: '/videos/ME-exporter-imprimer.mp4',
                                            title: 'Exporter son agenda en format PDF ou papier'
                                        },
                                        {
                                            src: '/videos/events-ruttl-de.mp4',
                                            title: 'Feedback',
                                            playbackRate: 0.5
                                        }
                                    ]}
                                />
                            </div>
                        </div>
                    )}
                </Section>
            </main>
        </Layout>
    );
});

export default Home;
